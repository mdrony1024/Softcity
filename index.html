<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Softcity</title> <!-- App Name Updated -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <!-- === GIGAPUB SDK === -->
    <script src="https://ad.gigapub.tech/script?id=1327"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root {
            --gradient-start: #7f52ff; --gradient-end: #d152ff;
            --light-bg: #f3f4f6; --light-card-bg: #ffffff; --light-text: #111827;
            --light-secondary-text: #6b7280; --light-border: #e5e7eb;
            --dark-bg: #1f2937; --dark-card-bg: #374151; --dark-text: #f9fafb;
            --dark-secondary-text: #9ca3af; --dark-border: #4b5563;
            --accent-color: #5856d6; --accent-hover: #4c4ac6; --gold: #ffc700;
            --silver: #c0c0c0; --bronze: #cd7f32;
        }
        body { font-family: 'Poppins', sans-serif; margin: 0; padding: 0 0 100px 0; transition: background-color 0.3s, color 0.3s; }
        body.light { --bg-color: var(--light-bg); --card-bg-color: var(--light-card-bg); --text-color: var(--light-text); --secondary-text-color: var(--light-secondary-text); --border-color: var(--light-border); }
        body.dark { --bg-color: var(--dark-bg); --card-bg-color: var(--dark-card-bg); --text-color: var(--dark-text); --secondary-text-color: var(--dark-secondary-text); --border-color: var(--dark-border); }
        body { background-color: var(--bg-color); color: var(--text-color); }
        .container { width: 100%; max-width: 500px; margin: 0 auto; padding: 0 15px; box-sizing: border-box; }
        .hidden { display: none !important; }
        .view { animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .top-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 15px; }
        .top-header .title { font-size: 20px; font-weight: 600; }
        #theme-toggle { background: var(--card-bg-color); border: 1px solid var(--border-color); color: var(--text-color); width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 18px; }
        .header-bg { background: linear-gradient(90deg, var(--gradient-start), var(--gradient-end)); height: 120px; border-radius: 0 0 30px 30px; margin: 0 -15px 0 -15px; position: absolute; top: 0; left: 0; right: 0; z-index: -1; }
        .profile-card { background: var(--card-bg-color); border-radius: 20px; padding: 20px; text-align: center; margin-top: 50px; box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1); position: relative; }
        .profile-pic { width: 80px; height: 80px; border-radius: 50%; background: #eee; margin: -60px auto 10px; border: 4px solid var(--card-bg-color); display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .profile-pic img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }
        #user-name { font-size: 20px; font-weight: 600; }
        #user-points { background-color: var(--accent-color); color: white; padding: 5px 15px; border-radius: 20px; display: inline-block; font-size: 14px; margin-top: 5px; }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0; }
        .stat-item .value { font-size: 18px; font-weight: 600; }
        .stat-item .label { font-size: 12px; color: var(--secondary-text-color); }
        .action-button { width: 100%; padding: 12px; background-color: transparent; border: 1px solid var(--accent-color); color: var(--accent-color); border-radius: 12px; font-size: 16px; font-weight: 500; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .action-button:hover { background-color: var(--accent-color); color: white; }
        .action-button:disabled { background-color: #ccc; border-color: #ccc; color: #666; cursor: not-allowed; }
        .card { background: var(--card-bg-color); border-radius: 15px; padding: 20px; margin-top: 20px; }
        .card-title { font-size: 18px; font-weight: 600; margin-bottom: 15px; }
        .notice-card { background-color: var(--accent-color); color: white; padding: 15px; border-radius: 10px; margin-top: 20px; text-align: center; }
        .form-group { margin-bottom: 15px; text-align: left; }
        .form-group label { display: block; font-size: 14px; font-weight: 500; margin-bottom: 5px; }
        .form-group input, .form-group select { width: 100%; padding: 12px; box-sizing: border-box; background: var(--bg-color); border: 1px solid var(--border-color); border-radius: 10px; color: var(--text-color); font-size: 14px; }
        .shop-item { border: 1px solid var(--border-color); border-radius: 10px; padding: 15px; margin-bottom: 15px; }
        .shop-item h4 { margin-top: 0; }
        .price-tag { font-size: 12px; color: var(--secondary-text-color); }
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background-color: var(--card-bg-color); display: flex; justify-content: space-around; padding: 10px 0; box-shadow: 0 -5px 15px rgba(0,0,0,0.1); border-top: 1px solid var(--border-color); z-index: 100; flex-wrap: wrap; }
        .nav-item { cursor: pointer; text-align: center; color: var(--secondary-text-color); font-size: 10px; display: flex; flex-direction: column; align-items: center; gap: 4px; transition: color 0.2s; padding: 0 5px; }
        .nav-item.active { color: var(--accent-color); }
        .nav-item svg { width: 24px; height: 24px; }
        
        /* === Daily Bonus CSS === */
        .bonus-container { padding: 20px; background: linear-gradient(45deg, var(--gradient-start), var(--gradient-end)); border-radius: 15px; color: white; }
        .bonus-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 20px; }
        .day-card { background: rgba(255, 255, 255, 0.2); border-radius: 10px; padding: 10px; text-align: center; transition: transform 0.2s; }
        .day-card.active { border: 2px solid white; transform: scale(1.05); }
        .day-card.claimed { background: rgba(130, 255, 130, 0.4); }
        .day-card.locked { opacity: 0.6; }
        .day-card .day { font-size: 12px; }
        .day-card .icon { font-size: 24px; margin: 5px 0; }
        .day-card .points { font-size: 16px; font-weight: bold; }
        .bonus-progress-bar { width: 100%; background: rgba(255, 255, 255, 0.3); height: 8px; border-radius: 4px; margin-top: 20px; overflow: hidden; }
        .bonus-progress { background: white; height: 100%; border-radius: 4px; width: 0%; transition: width 0.5s; }
        #claim-bonus-btn { background-color: white; color: var(--accent-color); margin-top: 20px; font-weight: bold; }

        /* === History & Leaderboard List Style === */
        .list-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 5px; border-bottom: 1px solid var(--border-color); }
        .list-item:last-child { border-bottom: none; }
        .list-item .info .main { font-weight: 500; }
        .list-item .info .sub { font-size: 12px; color: var(--secondary-text-color); }
        .list-item .status { font-weight: 600; padding: 3px 8px; border-radius: 8px; font-size: 12px; }
        .status.pending { background-color: #fef3c7; color: #92400e; }
        .status.approved, .status.completed { background-color: #d1fae5; color: #065f46; }
        .status.rejected { background-color: #fee2e2; color: #991b1b; }
        .leaderboard-item { display: flex; align-items: center; gap: 15px; padding: 8px 0; }
        .leaderboard-item .rank { font-size: 16px; font-weight: 600; color: var(--secondary-text-color); width: 25px; text-align: center;}
        .leaderboard-item .name { font-weight: 500; flex-grow: 1; cursor: pointer; }
        .leaderboard-item .points { font-weight: 600; color: var(--accent-color); }
        .leaderboard-item .name:hover { text-decoration: underline; }
    </style>
</head>
<body class="light">
    
    <div class="header-bg"></div>
    <div class="top-header container">
        <h1 class="title">Softcity üí∏</h1>
        <button id="theme-toggle">üåô</button>
    </div>

    <div class="container">
        <!-- Views Wrapper -->
        <div id="views-container">
            <!-- Home View -->
            <div id="home-view" class="view">
                 <div class="profile-card">
                    <div class="profile-pic"><img id="profile-img" src="" alt=""></div>
                    <h2 id="user-name">Loading...</h2>
                    <div id="user-points">0 Points</div>
                    <div class="stats-grid">
                        <div class="stat-item"><div class="value" id="stats-today-ads">0</div><div class="label">Today's Ads</div></div>
                        <div class="stat-item"><div class="value" id="stats-total-ads">0</div><div class="label">Total Ads</div></div>
                        <div class="stat-item"><div class="value" id="stats-referrals">0</div><div class="label">Referrals</div></div>
                    </div>
                    <button class="action-button" id="leaderboard-btn">üèÜ Leaderboard</button>
                </div>

                <div id="notice-card" class="card notice-card hidden">
                    <h3 class="card-title" style="color: white;">üì¢ Notice</h3>
                    <p id="notice-text" style="font-size: 14px;"></p>
                 </div>

                <div class="card">
                    <h3 class="card-title">Welcome, <span id="welcome-name">User</span>!</h3>
                    <p style="color:var(--secondary-text-color); font-size: 14px; margin-top: -10px;">Complete tasks, invite friends, and earn points.</p>
                    <button class="action-button" style="background-color: var(--accent-color); color: white;" id="join-channel-btn">üöÄ Join Channel</button>
                </div>
            </div>

            <!-- Tasks View -->
            <div id="tasks-view" class="view hidden">
                <div class="card">
                    <h3 class="card-title">Promote Services</h3>
                    <p style="color:var(--secondary-text-color); font-size: 14px; margin-top: -10px;">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶™‡ßç‡¶∞‡ßã‡¶Æ‡ßã‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
                    <button class="action-button" id="go-to-shop-btn" style="margin-top: 15px;">üöÄ Promote Now</button>
                </div>
                <div class="card">
                    <h3 class="card-title">Watch Ads & Earn</h3>
                    <p style="color:var(--secondary-text-color); font-size: 14px; margin-top: -10px;" id="ads-left-text">Loading...</p>
                    <button class="action-button" style="background-color: var(--accent-color); color: white;" id="watch-ad-btn" disabled>
                        <svg style="width:20px; height:20px;" viewBox="0 0 24 24"><path fill="currentColor" d="M22,10.45V13.55A1,1 0 0,1 21,14.55C20.84,14.55 20.68,14.5 20.53,14.43L18,13.35V16.5A1.5,1.5 0 0,1 16.5,18H3.5A1.5,1.5 0 0,1 2,16.5V7.5A1.5,1.5 0 0,1 3.5,6H16.5A1.5,1.5 0 0,1 18,7.5V10.65L20.53,9.57C20.83,9.44 21.17,9.5 21.39,9.73C21.5,9.84 21.56,10 21.56,10.15L22,10.45M10,10.5A1.5,1.5 0 0,0 8.5,12A1.5,1.5 0 0,0 10,13.5A1.5,1.5 0 0,0 11.5,12A1.5,1.5 0 0,0 10,10.5Z" /></svg>
                        <span>Watch Ad</span>
                    </button>
                </div>
            </div>

            <!-- Shop View -->
            <div id="shop-view" class="view hidden">
                 <div class="card">
                    <h3 class="card-title">üõí Shop</h3>
                    <p style="color:var(--secondary-text-color); font-size: 14px; margin-top: -10px;">Use your points to buy services.</p>
                    <div id="shop-items-container">
                        <p>Loading shop items...</p>
                    </div>
                </div>
            </div>

            <!-- Bonus View -->
            <div id="bonus-view" class="view hidden">
                <div class="card bonus-container">
                    <h3 class="card-title" style="color:white; border:none; text-align:center;">Daily Check-in Bonus</h3>
                    <p style="font-size: 14px; margin-top: -10px; text-align:center;">Claim your daily reward and keep your streak!</p>
                    <div id="bonus-grid" class="bonus-grid"></div>
                    <div class="bonus-progress-bar"><div id="bonus-progress" class="bonus-progress"></div></div>
                    <button class="action-button" id="claim-bonus-btn" disabled>Claim Reward</button>
                </div>
            </div>
            
            <!-- Withdraw, History, Referral, Leaderboard Views -->
            <div id="withdraw-view" class="view hidden">
                <div class="card" id="withdraw-card">
                    <h3 class="card-title">Withdraw Points</h3>
                    <div class="form-group">
                        <label>Balance: <span id="withdraw-balance">0</span> points</label>
                        <label style="font-size:12px; color:var(--secondary-text-color)">Min: <span id="min-withdraw">...</span></label>
                        <input type="number" id="withdraw-amount" placeholder="e.g., 20000">
                    </div>
                    <div class="form-group">
                        <label for="withdraw-method">Method</label>
                        <select id="withdraw-method"></select>
                    </div>
                    <div class="form-group"><label for="withdraw-account">Account Details</label><input type="text" id="withdraw-account" placeholder="Your account number or ID"></div>
                    <button class="action-button" id="submit-withdraw-btn" style="background-color: var(--accent-color); color: white;">Submit Request</button>
                </div>
                <div class="card hidden" id="withdraw-disabled-card"><p>Withdrawal is temporarily disabled. Please check back later.</p
